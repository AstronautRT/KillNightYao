<!DOCTYPE html>
<html>
<head>
    <title>åˆ˜è€€æ–‡æ–°æ­Œã€ŠKill Night è€€ã€‹éŸ³ä¹æ•°æ®ç›‘æ§é¢æ¿</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f0f2f5;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 24px;
        }

        h1 {
            color: #2d3436;
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .data-table th,
        .data-table td {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #e9ecef;
        }

        .data-table th {
            background-color: #f8f9fa;
            color: #495057;
            font-weight: 600;
        }

        .data-table tr:hover {
            background-color: #f8f9fa;
        }

        .update-time {
            text-align: right;
            color: #6c757d;
            font-size: 0.9em;
            margin-top: 15px;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #6c757d;
        }

        .metric-value {
            font-weight: bold;
            color: #2d3436;
            font-size: 1.1em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>æ­Œæ›²æ•°æ®ç›‘æ§ ğŸµ</h1>
        <div class="loading" id="loading">æ­£åœ¨åŠ è½½æ•°æ®...</div>
        <table class="data-table" id="data-table">
            <thead>
                <tr>
                    <th>æ—¶é—´</th>
                    <th>æ’­æ”¾åº¦</th>
                    <th>æ¨èåº¦</th>
                    <th>ç•…é”€åº¦</th>
                    <th>æ€»åˆ†</th>
                    <th>æ€»åˆ†å°åˆ†</th>
                </tr>
            </thead>
            <tbody id="table-body">
                <!-- æ•°æ®å°†åŠ¨æ€æ’å…¥åˆ°è¿™é‡Œ -->
            </tbody>
        </table>
        <div class="update-time" id="update-time"></div>
    </div>

    <script>
        // é…ç½®å‚æ•°
        const API_URL = 'https://yobank.tencentmusic.com/unichartsapi/v1/songs/394941424/charts_detail';
        const REFRESH_INTERVAL = 60000; // 1åˆ†é’Ÿåˆ·æ–°ä¸€æ¬¡

        // æ˜¾ç¤ºé…ç½®ï¼ˆæ ¹æ®å®é™…APIè¿”å›å­—æ®µä¿®æ”¹ï¼‰
        const DISPLAY_FIELDS = [
            { key: 'rank', name: 'æ—¶é—´', unit: 'ä½' },
            { key: 'play_count', name: 'æ’­æ”¾é‡', unit: 'æ¬¡' },
            { key: 'share_count', name: 'åˆ†äº«é‡', unit: 'æ¬¡' },
            { key: 'favorite_count', name: 'æ”¶è—é‡', unit: 'æ¬¡' }
        ];

        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        function toggleLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
            document.getElementById('data-table').style.display = show ? 'none' : 'table';
        }

        // åˆ›å»ºè¡¨æ ¼è¡Œ
        function createTableRow({ name, value, unit }) {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${name}</td>
                <td class="metric-value">${value ?? 'N/A'}</td>
                <td>${unit}</td>
            `;
            return tr;
        }

        // æ›´æ–°è¡¨æ ¼æ•°æ®
        async function updateTable() {
            try {
                toggleLoading(true);
                const response = await fetch(API_URL);
                const data = await response.json();

                const tbody = document.getElementById('table-body');
                tbody.innerHTML = ''; // æ¸…ç©ºæ—§æ•°æ®

                DISPLAY_FIELDS.forEach(field => {
                    const value = data.data?.[field.key] ?? 'N/A';
                    tbody.appendChild(createTableRow({
                        name: field.name,
                        value: typeof value === 'number' ? value.toLocaleString() : value,
                        unit: field.unit
                    }));
                });

                document.getElementById('update-time').textContent =
                    `æœ€åæ›´æ–°æ—¶é—´ï¼š${new Date().toLocaleTimeString()}`;
            } catch (error) {
                console.error('è·å–æ•°æ®å¤±è´¥:', error);
                document.getElementById('table-body').innerHTML = `
                    <tr>
                        <td colspan="3" style="color: #dc3545;">æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•</td>
                    </tr>
                `;
            } finally {
                toggleLoading(false);
            }
        }

        // åˆå§‹åŒ–
        updateTable();
        setInterval(updateTable, REFRESH_INTERVAL);
    </script>
</body>
</html>
